import{_ as $,r as b,k as u,l as q,c as l,f as M,a as e,d as c,b as I,v as z,t as n,F as f,m as S,p as L,q as h,o,e as r}from"./index-BT3okxWX.js";import{B as G}from"./BackButton-8ABwIVY3.js";const H={class:"order-page"},J={key:0,class:"loading"},Q={key:1},U={class:"search-container"},j={class:"orders-container"},R={class:"active-orders"},W={class:"pagination pagination-left"},X=["disabled"],Y=["disabled"],Z={key:0,class:"empty"},tt={key:1,class:"order-list"},et={class:"order-header"},st={class:"order-id"},nt={class:"order-status"},it={class:"order-total"},lt={class:"order-date"},ot={class:"order-details-text"},rt={key:0},at={key:2},dt={class:"order-details-text"},ut={key:0,class:"order-products"},pt={class:"product-list-container"},ct={class:"product-list"},gt=["href"],mt=["src","alt"],vt={class:"product-info"},yt={class:"product-name"},ft={class:"product-quantity"},ht={class:"order-actions"},kt=["onClick"],_t={class:"order-history"},bt={class:"pagination pagination-right"},Bt=["disabled"],xt=["disabled"],Ot={key:0,class:"empty"},wt={key:1,class:"order-list"},St={class:"order-header"},Dt={class:"order-id"},Pt={class:"order-status"},Ct={class:"order-total"},At={class:"order-date"},Lt={class:"order-details-text"},Nt={key:0},Kt={key:2},Tt={class:"order-details-text"},Ft={key:0,class:"order-products"},Et={class:"product-list-container"},Vt={class:"product-list"},$t=["href"],qt=["src","alt"],Mt={class:"product-info"},It={class:"product-name"},zt={class:"product-quantity"},k=3,Gt={__name:"OrderDetail",setup(Ht){const D=b([]),B=b(!1),g=b(""),m=b(1),v=b(1),N=async()=>{var i,t;B.value=!0;try{const{data:s}=await L.get("/api/order/detail");D.value=s}catch(s){console.error("Error loading orders:",s),await h.fire({title:"Fehler",text:((t=(i=s.response)==null?void 0:i.data)==null?void 0:t.error)||"Ein unbekannter Fehler ist aufgetreten.",icon:"error",confirmButtonText:"OK"})}finally{B.value=!1}},A=u(()=>[...D.value].sort((i,t)=>t.updatedAt-i.updatedAt)),K=u(()=>A.value.filter(i=>["open","processing"].includes(i.orderStatus))),T=u(()=>A.value.filter(i=>["failed","successful","refunded","canceled"].includes(i.orderStatus))),P=u(()=>K.value.filter(i=>i.id.toString().includes(g.value)||i.orderProducts.some(t=>t.product.name.toLowerCase().includes(g.value.toLowerCase())))),C=u(()=>T.value.filter(i=>i.id.toString().includes(g.value)||i.orderProducts.some(t=>t.product.name.toLowerCase().includes(g.value.toLowerCase())))),F=u(()=>{const i=(m.value-1)*k,t=i+k;return P.value.slice(i,t)}),E=u(()=>{const i=(v.value-1)*k,t=i+k;return C.value.slice(i,t)}),x=u(()=>Math.ceil(P.value.length/k)),O=u(()=>Math.ceil(C.value.length/k)),w=i=>new Date(i).toLocaleDateString("de-DE"),V=async i=>{var t,s;try{const d=D.value.find(p=>p.id===i);if(!d){await h.fire({title:"Bestellung nicht gefunden",text:"Die angegebene Bestellung existiert nicht.",icon:"warning",confirmButtonText:"OK"});return}if(!["open","processing"].includes(d.orderStatus)){await h.fire({title:"Stornierung nicht möglich",text:"Nur offene oder in Bearbeitung befindliche Bestellungen können storniert werden.",icon:"info",confirmButtonText:"OK"});return}if(!(await h.fire({title:"Bestellung stornieren?",text:"Möchten Sie diese Bestellung wirklich stornieren? Dies kann nicht rückgängig gemacht werden.",icon:"question",showCancelButton:!0,confirmButtonText:"Ja, stornieren",cancelButtonText:"Abbrechen"})).isConfirmed)return;await L.patch(`/api/order/${i}/cancel`),d.orderStatus="canceled",await h.fire({title:"Erfolgreich storniert",text:"Die Bestellung wurde erfolgreich storniert.",icon:"success",confirmButtonText:"OK"})}catch(d){console.error("Fehler beim Stornieren der Bestellung:",d),await h.fire({title:"Fehler",text:((s=(t=d.response)==null?void 0:t.data)==null?void 0:s.error)||"Die Bestellung konnte nicht storniert werden.",icon:"error",confirmButtonText:"OK"})}};return q(()=>{N()}),(i,t)=>(o(),l("div",H,[M(G),t[36]||(t[36]=e("h2",{class:"page-title form-label"},"Meine Bestellungen",-1)),B.value?(o(),l("div",J,t[5]||(t[5]=[e("p",null,"Loading orders...",-1)]))):c("",!0),B.value?c("",!0):(o(),l("div",Q,[e("div",U,[I(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>g.value=s),type:"text",placeholder:"Suche nach Bestellung-ID...",maxlength:"50",class:"search-input"},null,512),[[z,g.value]])]),e("div",j,[e("section",R,[t[20]||(t[20]=e("h3",{class:"section-title"},"Aktive Bestellungen",-1)),e("div",W,[e("button",{disabled:m.value===1||x.value===0,onClick:t[1]||(t[1]=s=>m.value--)}," Vorherige ",8,X),e("span",null,"Seite "+n(m.value)+" von "+n(x.value),1),e("button",{disabled:m.value===x.value||x.value===0,onClick:t[2]||(t[2]=s=>m.value++)}," Nächste ",8,Y)]),P.value.length===0?(o(),l("div",Z,t[6]||(t[6]=[e("p",null,"Keine aktiven Bestellungen vorhanden.",-1)]))):(o(),l("div",tt,[(o(!0),l(f,null,S(F.value,s=>{var d,y,p,_;return o(),l("div",{key:s.id,class:"order-item"},[e("div",et,[e("p",st,[t[7]||(t[7]=e("strong",null,"Order ID:",-1)),r(" "+n(s.id),1)]),e("p",nt,[t[8]||(t[8]=e("strong",null,"Status:",-1)),r(" "+n(s.orderStatus),1)]),e("p",it,[t[9]||(t[9]=e("strong",null,"Gesamt:",-1)),r(" €"+n(s.totalAmount.toFixed(2)),1)]),e("p",lt,[t[10]||(t[10]=e("strong",null,"Bestellt am:",-1)),r(" "+n(w(s.createdAt)),1)])]),e("div",ot,[e("p",null,[t[11]||(t[11]=e("strong",null,"Bezahlmethode:",-1)),r(" "+n(((d=s.payment)==null?void 0:d.paymentOption)||"Keine Angaben"),1)]),((y=s.payment)==null?void 0:y.paymentOption)==="bank transfer"?(o(),l("p",rt,[t[12]||(t[12]=e("strong",null,"IBAN:",-1)),r(" "+n(s.payment.iban),1)])):((p=s.payment)==null?void 0:p.paymentOption)==="credit card"?(o(),l(f,{key:1},[e("p",null,[t[13]||(t[13]=e("strong",null,"Kreditkartennummer:",-1)),r(" "+n(s.payment.creditCardNumber),1)]),e("p",null,[t[14]||(t[14]=e("strong",null,"Ablaufdatum:",-1)),r(" "+n(s.payment.expiryDate),1)])],64)):((_=s.payment)==null?void 0:_.paymentOption)==="paypal"?(o(),l("p",at,[t[15]||(t[15]=e("strong",null,"PayPal Email:",-1)),r(" "+n(s.payment.paypalEmail),1)])):c("",!0)]),e("div",dt,[e("p",null,[t[16]||(t[16]=e("strong",null,"Lieferstatus:",-1)),r(" "+n(s.shipping.deliveryStatus),1)]),e("p",null,[t[17]||(t[17]=e("strong",null,"Lieferadresse:",-1)),r(" "+n(s.shipping.address.street)+" "+n(s.shipping.address.houseNumber)+", "+n(s.shipping.address.city)+", "+n(s.shipping.address.postalCode),1)]),e("p",null,[t[18]||(t[18]=e("strong",null,"Voraussichtliche Lieferung:",-1)),r(" "+n(w(s.shipping.estimatedDeliveryDate)),1)])]),s.orderProducts.length>0?(o(),l("div",ut,[t[19]||(t[19]=e("p",{class:"products-header"},[e("strong",null,"Produkte:")],-1)),e("div",pt,[e("ul",ct,[(o(!0),l(f,null,S(s.orderProducts,a=>(o(),l("li",{key:a.id,class:"product-item"},[e("a",{href:`/product/${a.product.id}`,class:"product-link"},[e("img",{src:a.product.image,alt:a.product.name,class:"product-image"},null,8,mt),e("div",vt,[e("p",yt,n(a.product.name),1),e("p",ft,n(a.quantity)+"x (€"+n(a.product.price.toFixed(2))+") ",1)])],8,gt)]))),128))])])])):c("",!0),e("div",ht,[s.orderStatus!=="cancel"?(o(),l("button",{key:0,class:"btn-secondary",onClick:a=>V(s.id)}," Bestellung stornieren ",8,kt)):c("",!0)])])}),128))]))]),e("section",_t,[t[35]||(t[35]=e("h3",{class:"section-title"},"Bestellhistorie",-1)),e("div",bt,[e("button",{disabled:v.value===1||O.value===0,onClick:t[3]||(t[3]=s=>v.value--)}," Vorherige ",8,Bt),e("span",null,"Seite "+n(v.value)+" von "+n(O.value),1),e("button",{disabled:v.value===O.value||O.value===0,onClick:t[4]||(t[4]=s=>v.value++)}," Nächste ",8,xt)]),C.value.length===0?(o(),l("div",Ot,t[21]||(t[21]=[e("p",null,"Keine abgeschlossenen Bestellungen vorhanden.",-1)]))):(o(),l("div",wt,[(o(!0),l(f,null,S(E.value,s=>{var d,y,p,_;return o(),l("div",{key:s.id,class:"order-item"},[e("div",St,[e("p",Dt,[t[22]||(t[22]=e("strong",null,"Order ID:",-1)),r(" "+n(s.id),1)]),e("p",Pt,[t[23]||(t[23]=e("strong",null,"Status:",-1)),r(" "+n(s.orderStatus),1)]),e("p",Ct,[t[24]||(t[24]=e("strong",null,"Gesamt:",-1)),r(" €"+n(s.totalAmount.toFixed(2)),1)]),e("p",At,[t[25]||(t[25]=e("strong",null,"Bestellt am:",-1)),r(" "+n(w(s.createdAt)),1)])]),e("div",Lt,[e("p",null,[t[26]||(t[26]=e("strong",null,"Bezahlmethode:",-1)),r(" "+n(((d=s.payment)==null?void 0:d.paymentOption)||"Keine Angaben"),1)]),((y=s.payment)==null?void 0:y.paymentOption)==="bank transfer"?(o(),l("p",Nt,[t[27]||(t[27]=e("strong",null,"IBAN:",-1)),r(" "+n(s.payment.iban),1)])):((p=s.payment)==null?void 0:p.paymentOption)==="credit card"?(o(),l(f,{key:1},[e("p",null,[t[28]||(t[28]=e("strong",null,"Kreditkartennummer:",-1)),r(" "+n(s.payment.creditCardNumber),1)]),e("p",null,[t[29]||(t[29]=e("strong",null,"Ablaufdatum:",-1)),r(" "+n(s.payment.expiryDate),1)])],64)):((_=s.payment)==null?void 0:_.paymentOption)==="paypal"?(o(),l("p",Kt,[t[30]||(t[30]=e("strong",null,"PayPal Email:",-1)),r(" "+n(s.payment.paypalEmail),1)])):c("",!0)]),e("div",Tt,[e("p",null,[t[31]||(t[31]=e("strong",null,"Lieferstatus:",-1)),r(" "+n(s.shipping.deliveryStatus),1)]),e("p",null,[t[32]||(t[32]=e("strong",null,"Lieferadresse:",-1)),r(" "+n(s.shipping.address.street)+" "+n(s.shipping.address.houseNumber)+", "+n(s.shipping.address.city)+", "+n(s.shipping.address.postalCode),1)]),e("p",null,[t[33]||(t[33]=e("strong",null,"Voraussichtliche Lieferung:",-1)),r(" "+n(w(s.shipping.estimatedDeliveryDate)),1)])]),s.orderProducts.length>0?(o(),l("div",Ft,[t[34]||(t[34]=e("p",{class:"products-header"},[e("strong",null,"Produkte:")],-1)),e("div",Et,[e("ul",Vt,[(o(!0),l(f,null,S(s.orderProducts,a=>(o(),l("li",{key:a.id,class:"product-item"},[e("a",{href:`/product/${a.product.id}`,class:"product-link"},[e("img",{src:a.product.image,alt:a.product.name,class:"product-image"},null,8,qt),e("div",Mt,[e("p",It,n(a.product.name),1),e("p",zt,n(a.quantity)+"x (€"+n(a.product.price.toFixed(2))+") ",1)])],8,$t)]))),128))])])])):c("",!0)])}),128))]))])])]))]))}},Ut=$(Gt,[["__scopeId","data-v-62776dee"]]);export{Ut as default};
