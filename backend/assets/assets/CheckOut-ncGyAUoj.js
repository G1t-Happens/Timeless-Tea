import{_ as F,o as i,C as Q,g as N,c as d,a as e,F as S,m as U,t as n,e as h,d as A,w as L,T as j,H as W,u as J,r as c,k as O,l as X,f as k,i as C,b as m,v as p,x as Y,p as P,q,h as _,n as ee,s as te}from"./index-Cy6hZbvz.js";import{B as se}from"./BackButton-C7Seo1Gr.js";const ne={class:"modal-container"},le={class:"order-summary"},ie={class:"summary-table"},de={class:"summary-total"},ae={class:"user-info"},oe={class:"payment-info"},re={key:0},ue={key:0},me={key:1},pe={key:2},ye={key:1},ve={class:"shipping-info"},be={key:0},he={key:1},fe={key:0},ge={key:1},ce={__name:"OrderConfirmationModal",props:{show:{type:Boolean,required:!0},user:{type:Object,required:!0},cartItems:{type:Array,required:!0},totalAmount:{type:Number,required:!0},payment:{type:Object,required:!1},useBillingAsShipping:{type:Boolean,required:!0},shippingAddress:{type:Object,required:!0}},emits:["close","confirm"],setup(l,{emit:y}){const x=y,B=()=>x("close"),f=()=>x("confirm");return(g,a)=>(i(),Q(j,{name:"fade-modal"},{default:N(()=>[l.show?(i(),d("div",{key:0,class:"modal-backdrop",onClick:L(B,["self"])},[e("div",ne,[a[8]||(a[8]=e("h2",null,"Bestellzusammenfassung",-1)),e("div",le,[a[1]||(a[1]=e("h3",null,"Produkte",-1)),e("table",ie,[a[0]||(a[0]=e("thead",null,[e("tr",null,[e("th",null,"Produkt"),e("th",null,"Artikel"),e("th",null,"Preis (€)"),e("th",null,"Gesamt (€)")])],-1)),e("tbody",null,[(i(!0),d(S,null,U(l.cartItems,v=>(i(),d("tr",{key:v.id},[e("td",null,n(v.name),1),e("td",null,n(v.productQuantity),1),e("td",null,n(v.price.toFixed(2)),1),e("td",null,n((v.price*v.productQuantity).toFixed(2)),1)]))),128))])]),e("div",de,[e("strong",null,"Gesamtsumme: "+n(l.totalAmount.toFixed(2))+" €",1)])]),e("div",ae,[a[2]||(a[2]=e("h3",null,"Rechnungsadresse",-1)),e("p",null,n(l.user.firstName)+" "+n(l.user.lastName),1),e("p",null,n(l.user.emailAddress),1),e("p",null,n(l.user.address.street)+" "+n(l.user.address.houseNumber)+", "+n(l.user.address.postalCode)+" "+n(l.user.address.city)+", "+n(l.user.address.country),1)]),e("div",oe,[a[5]||(a[5]=e("h3",null,"Zahlungsmethode",-1)),l.payment&&l.payment.paymentOption?(i(),d("p",re,[h(" Option: "+n(l.payment.paymentOption),1),a[4]||(a[4]=e("br",null,null,-1)),l.payment.paymentOption==="bank transfer"?(i(),d("span",ue," IBAN: "+n(l.payment.iban),1)):l.payment.paymentOption==="credit card"?(i(),d("span",me,[h(" Kreditkartennummer: **** **** **** "+n(l.payment.creditCardNumber.slice(-4)),1),a[3]||(a[3]=e("br",null,null,-1)),h(" Ablaufdatum: "+n(l.payment.expiryDate||"n/a"),1)])):l.payment.paymentOption==="paypal"?(i(),d("span",pe," PayPal E-Mail: "+n(l.payment.paypalEmail),1)):A("",!0)])):(i(),d("p",ye,"Keine Zahlungsmethode hinterlegt."))]),e("div",ve,[a[7]||(a[7]=e("h3",null,"Versandinformationen",-1)),l.useBillingAsShipping?(i(),d("div",be,a[6]||(a[6]=[e("p",null,"Die Versandadresse entspricht der Rechnungsadresse.",-1)]))):(i(),d("div",he,[e("p",null,n(l.shippingAddress.street)+" "+n(l.shippingAddress.houseNumber)+", "+n(l.shippingAddress.postalCode)+" "+n(l.shippingAddress.city)+", "+n(l.shippingAddress.country),1),l.shippingAddress.addressAddition?(i(),d("p",fe," Zusatz: "+n(l.shippingAddress.addressAddition),1)):A("",!0),l.shippingAddress.state?(i(),d("p",ge,"Bundesland: "+n(l.shippingAddress.state),1)):A("",!0)]))]),e("div",{class:"modal-actions"},[e("button",{class:"btn btn-success",onClick:f},"Bestellung bestätigen"),e("button",{class:"btn btn-danger",onClick:B},"Abbrechen")])])])):A("",!0)]),_:1}))}},ke=F(ce,[["__scopeId","data-v-876ae64f"]]),Ae={class:"checkout"},xe={key:0,class:"empty-cart"},Ce={key:1,class:"checkout-container"},Ne={class:"order-summary"},Be={class:"summary-table"},Ve={class:"summary-total"},Oe={key:0,class:"error-message"},Se={class:"user-details"},Ue={class:"edit-hint"},we={class:"detail-item"},$e={class:"detail-item"},Pe={class:"detail-item"},qe={class:"detail-item"},Fe={class:"detail-item"},Ie={class:"detail-item"},Ee={class:"detail-item"},Me={class:"detail-item"},ze={class:"payment-method"},De={key:0},Ze={class:"edit-hint"},Te={class:"payment-list-container"},Re=["onClick"],Ke={class:"payment-option"},Ge={key:0},He={key:1},Qe={key:2},Le={key:1},je={class:"shipping-info"},We={class:"checkbox-wrapper"},Je={key:0},Xe={key:1},Ye={class:"detail-item"},_e={class:"detail-item"},et={class:"detail-item"},tt={class:"detail-item"},st={class:"detail-item"},nt={class:"detail-item"},lt={class:"detail-item"},it={class:"checkout-actions"},dt=["disabled"],at={__name:"CheckOut",setup(l){const y=W(),x=J(),B=te(),f=c([]),g=c(null),a=c(!1),v=c(!0),u=c({country:"",postalCode:"",city:"",street:"",houseNumber:"",addressAddition:"",state:""}),r=c({id:null,emailAddress:"",firstName:"",lastName:"",address:{id:null,street:"",houseNumber:"",addressAddition:"",city:"",postalCode:"",country:""},payment:{paymentOption:null,iban:null,creditCardNumber:null,expiryDate:null,cvc:null,paypalEmail:null}}),I=O(()=>y.totalAmount<=1e6),E=O(()=>y.totalAmount>1e6),w=O(()=>y.items.length>0&&x.user&&r.value.address&&g.value&&I.value),M=()=>f.value.find(o=>o.id===g.value)||null,z=async()=>{try{const o=await P.get(`/api/user/${x.user.id}`);r.value=o.data,f.value=o.data.payments.filter(t=>!t.isForOrder)}catch(o){console.error("Fehler beim Laden des Benutzers oder der Zahlungsdaten:",o)}},D=o=>o?"**** **** **** "+o.slice(-4):"n/a",Z=o=>{if(!o)return"n/a";const t=o.replace(/\s/g,"");return t.slice(0,4)+" **** **** "+t.slice(-2)},T=o=>{if(!o)return"n/a";const[t,b]=o.split("@");return!t||!b?"n/a":t.charAt(0)+"****@"+b},R=o=>{g.value=o},K=()=>{a.value=!0},$=()=>{a.value=!1},G=async()=>{$(),await H()},H=async()=>{var o,t;if(!w.value){await q.fire({title:"Erforderliche Informationen fehlen",text:"Bitte stellen Sie sicher, dass alle erforderlichen Informationen ausgefüllt sind.",icon:"warning",confirmButtonText:"OK"});return}try{const b={totalAmount:parseFloat(y.totalAmount),payment:g.value,orderProducts:y.items.map(V=>({product:V.id,quantity:V.productQuantity})),newShippingAddress:v.value?null:{...u.value}},s=await P.post("/api/order",b);y.clearCart(),await B.push({name:"OrderSuccess",query:{id:s.data.id}})}catch(b){console.error("Fehler beim Abschicken der Bestellung:",b),await q.fire({title:"Fehler beim Abschicken der Bestellung!",text:((t=(o=b.response)==null?void 0:o.data)==null?void 0:t.error)||"Ein unbekannter Fehler ist aufgetreten.",icon:"error",confirmButtonText:"OK"})}};return X(async()=>{await z()}),(o,t)=>{const b=_("router-link");return i(),d("div",Ae,[t[50]||(t[50]=e("h1",{class:"checkout-title"},"Checkout",-1)),k(se),C(y).items.length===0?(i(),d("div",xe,[t[17]||(t[17]=e("p",null,"Ihr Warenkorb ist leer.",-1)),k(b,{to:"/",class:"btn btn-primary"},{default:N(()=>t[16]||(t[16]=[h("Zurück zum Shop")])),_:1})])):(i(),d("div",Ce,[e("div",Ne,[t[20]||(t[20]=e("h2",null,"Bestellübersicht",-1)),e("table",Be,[t[18]||(t[18]=e("thead",null,[e("tr",null,[e("th",null,"Produkt"),e("th",null,"Artikel"),e("th",null,"Preis (€)"),e("th",null,"Gesamt (€)")])],-1)),e("tbody",null,[(i(!0),d(S,null,U(C(y).items,s=>(i(),d("tr",{key:s.id},[e("td",null,n(s.name),1),e("td",null,n(s.productQuantity),1),e("td",null,n(s.price.toFixed(2)),1),e("td",null,n((s.price*s.productQuantity).toFixed(2)),1)]))),128))])]),e("div",Ve,[e("strong",null,"Gesamtsumme: "+n(C(y).totalAmount.toFixed(2))+" €",1)]),E.value?(i(),d("div",Oe,t[19]||(t[19]=[e("p",null,"Die Gesamtsumme darf 1.000.000 € nicht überschreiten.",-1)]))):A("",!0)]),e("div",Se,[t[33]||(t[33]=e("h2",null,"Rechnungsadresse",-1)),e("p",Ue,[t[22]||(t[22]=e("strong",null,"Hinweis:",-1)),t[23]||(t[23]=h(" Falls Sie Ihre Rechnungsadresse ändern möchten, können Sie das ")),k(b,{to:{name:"UserEditUser"}},{default:N(()=>t[21]||(t[21]=[h("hier")])),_:1}),t[24]||(t[24]=h(" erledigen. "))]),e("div",we,[t[25]||(t[25]=e("label",{for:"firstName"},"Vorname:",-1)),m(e("input",{id:"firstName",type:"text","onUpdate:modelValue":t[0]||(t[0]=s=>r.value.firstName=s),disabled:""},null,512),[[p,r.value.firstName]])]),e("div",$e,[t[26]||(t[26]=e("label",{for:"lastName"},"Nachname:",-1)),m(e("input",{id:"lastName",type:"text","onUpdate:modelValue":t[1]||(t[1]=s=>r.value.lastName=s),disabled:""},null,512),[[p,r.value.lastName]])]),e("div",Pe,[t[27]||(t[27]=e("label",{for:"email"},"E-Mail:",-1)),m(e("input",{id:"email",type:"email","onUpdate:modelValue":t[2]||(t[2]=s=>r.value.emailAddress=s),disabled:""},null,512),[[p,r.value.emailAddress]])]),e("div",qe,[t[28]||(t[28]=e("label",{for:"country"},"Land:",-1)),m(e("input",{id:"country",type:"text","onUpdate:modelValue":t[3]||(t[3]=s=>r.value.address.country=s),disabled:""},null,512),[[p,r.value.address.country]])]),e("div",Fe,[t[29]||(t[29]=e("label",{for:"postalCode"},"Postleitzahl:",-1)),m(e("input",{id:"postalCode",type:"text","onUpdate:modelValue":t[4]||(t[4]=s=>r.value.address.postalCode=s),disabled:""},null,512),[[p,r.value.address.postalCode]])]),e("div",Ie,[t[30]||(t[30]=e("label",{for:"city"},"Stadt:",-1)),m(e("input",{id:"city",type:"text","onUpdate:modelValue":t[5]||(t[5]=s=>r.value.address.city=s),disabled:""},null,512),[[p,r.value.address.city]])]),e("div",Ee,[t[31]||(t[31]=e("label",{for:"street"},"Straße:",-1)),m(e("input",{id:"street",type:"text","onUpdate:modelValue":t[6]||(t[6]=s=>r.value.address.street=s),disabled:""},null,512),[[p,r.value.address.street]])]),e("div",Me,[t[32]||(t[32]=e("label",{for:"houseNumber"},"Hausnummer:",-1)),m(e("input",{id:"houseNumber",type:"text","onUpdate:modelValue":t[7]||(t[7]=s=>r.value.address.houseNumber=s),disabled:""},null,512),[[p,r.value.address.houseNumber]])])]),e("div",ze,[t[39]||(t[39]=e("h2",null,"Zahlungsmethode",-1)),f.value.length>0?(i(),d("div",De,[e("p",Ze,[t[35]||(t[35]=h(" Hinweis: Wählen Sie eine der hinterlegten Zahlungsmethoden aus oder ")),k(b,{to:{name:"UserEditUser"}},{default:N(()=>t[34]||(t[34]=[h("fügen Sie eine neue hinzu.")])),_:1})]),e("div",Te,[(i(!0),d(S,null,U(f.value,s=>(i(),d("div",{key:s.id,class:ee(["payment-panel",{active:g.value===s.id}]),onClick:V=>R(s.id)},[e("p",Ke,"Option: "+n(s.paymentOption),1),s.paymentOption==="bank transfer"?(i(),d("div",Ge,[e("p",null,"IBAN: "+n(Z(s.iban)),1)])):s.paymentOption==="credit card"?(i(),d("div",He,[e("p",null,"Kreditkartennummer: "+n(D(s.creditCardNumber)),1),e("p",null,"Ablaufdatum: "+n(s.expiryDate||"n/a"),1)])):s.paymentOption==="paypal"?(i(),d("div",Qe,[e("p",null,"PayPal E-Mail: "+n(T(s.paypalEmail)),1)])):A("",!0)],10,Re))),128))])])):(i(),d("div",Le,[e("p",null,[t[37]||(t[37]=h(" Keine Zahlungsmethode hinterlegt. Bitte ")),k(b,{to:{name:"UserEditUser"}},{default:N(()=>t[36]||(t[36]=[h(" hinterlegen Sie Ihre Zahlungsdaten! ")])),_:1}),t[38]||(t[38]=h(" . "))])]))]),e("div",je,[t[49]||(t[49]=e("h2",null,"Versandinformationen",-1)),e("div",We,[m(e("input",{type:"checkbox",id:"use-billing-as-shipping","onUpdate:modelValue":t[8]||(t[8]=s=>v.value=s)},null,512),[[Y,v.value]]),t[40]||(t[40]=e("label",{for:"use-billing-as-shipping"}," Versandadresse ist identisch mit der Rechnungsadresse ",-1))]),v.value?(i(),d("div",Je,t[41]||(t[41]=[e("p",null,"Die Versandadresse entspricht der oben angegebenen Rechnungsadresse.",-1)]))):(i(),d("div",Xe,[e("div",Ye,[t[42]||(t[42]=e("label",{for:"ship-country"},"Land*:",-1)),m(e("input",{id:"ship-country",type:"text","onUpdate:modelValue":t[9]||(t[9]=s=>u.value.country=s),maxlength:"60",required:""},null,512),[[p,u.value.country]])]),e("div",_e,[t[43]||(t[43]=e("label",{for:"ship-postal-code"},"Postleitzahl*:",-1)),m(e("input",{id:"ship-postal-code",type:"text","onUpdate:modelValue":t[10]||(t[10]=s=>u.value.postalCode=s),maxlength:"10",required:""},null,512),[[p,u.value.postalCode]])]),e("div",et,[t[44]||(t[44]=e("label",{for:"ship-city"},"Stadt*:",-1)),m(e("input",{id:"ship-city",type:"text","onUpdate:modelValue":t[11]||(t[11]=s=>u.value.city=s),maxlength:"50",required:""},null,512),[[p,u.value.city]])]),e("div",tt,[t[45]||(t[45]=e("label",{for:"ship-street"},"Straße*:",-1)),m(e("input",{id:"ship-street",type:"text","onUpdate:modelValue":t[12]||(t[12]=s=>u.value.street=s),maxlength:"30",required:""},null,512),[[p,u.value.street]])]),e("div",st,[t[46]||(t[46]=e("label",{for:"ship-house-number"},"Hausnummer*:",-1)),m(e("input",{id:"ship-house-number",type:"text","onUpdate:modelValue":t[13]||(t[13]=s=>u.value.houseNumber=s),maxlength:"8",required:""},null,512),[[p,u.value.houseNumber]])]),e("div",nt,[t[47]||(t[47]=e("label",{for:"ship-addition"},"Adresszusatz (optional):",-1)),m(e("input",{id:"ship-addition",type:"text","onUpdate:modelValue":t[14]||(t[14]=s=>u.value.addressAddition=s),maxlength:"150"},null,512),[[p,u.value.addressAddition]])]),e("div",lt,[t[48]||(t[48]=e("label",{for:"ship-state"},"Bundesland (optional):",-1)),m(e("input",{id:"ship-state",type:"text","onUpdate:modelValue":t[15]||(t[15]=s=>u.value.state=s),maxlength:"50"},null,512),[[p,u.value.state]])])]))]),e("div",it,[e("button",{onClick:K,class:"btn btn-success",disabled:!w.value}," Bestellung abschicken ",8,dt)])])),k(ke,{show:a.value,user:r.value,cartItems:C(y).items,totalAmount:Number(C(y).totalAmount),payment:M(),useBillingAsShipping:v.value,shippingAddress:u.value,onClose:$,onConfirm:G},null,8,["show","user","cartItems","totalAmount","payment","useBillingAsShipping","shippingAddress"])])}}},ut=F(at,[["__scopeId","data-v-04e808f5"]]);export{ut as default};
