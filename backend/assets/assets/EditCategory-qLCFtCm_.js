import{_ as M,r as c,x as U,k as I,l as L,c as l,a as t,f as O,e as h,F as T,m as z,t as p,p as P,o,n as V,b as D,v as E}from "./index-S2dVXRzt.js";import{B as J}from "./BackButton-CpLP0EiE.js";const j={class:"edit-category"},H={class:"back-button-wrapper"},R={key:0,class:"text-center"},W={key:1},Z={class:"table-wrapper"},q={class:"table"},A=["onDblclick"],G=["onUpdate:modelValue","onInput","onBlur"],Q={key:1},X=["onUpdate:modelValue","onInput","onBlur"],Y={key:1},ee={class:"pagination"},ne=["disabled"],te=["disabled"],se={class:"actions"},ie=["disabled"],f=10,ae={__name:"EditCategory",setup(le){const u=c([]),v=c([]),m=c({}),d=U([]),r=c(1),b=c(!0),k=async()=>{try{const{data:e}=await P.get("/api/category");u.value=e,v.value=JSON.parse(JSON.stringify(e))}catch(e){console.error("Fehler beim Laden der Kategorien:",e)}finally{b.value=!1}},N=I(()=>{const e=(r.value-1)*f;return u.value.slice(e,e+f)}),_=I(()=>Math.ceil(u.value.length/f)),S=()=>{r.value>1&&r.value--},$=()=>{r.value<_.value&&r.value++},F= e=>{m.value[e]=!0},x= e=>{m.value[e]&&(m.value[e]=!1,B(e))},C= e=>!!m.value[e],y=(e, i)=>{const n=u.value.find(s=>s.id===e);if(n){const s=v.value.find(a=>a.id===e);s&&n[i]!==s[i]&&B(e)}},B= e=>{const i=u.value.find(s=>s.id===e),n=v.value.find(s=>s.id===e);if(i&&n)if(Object.keys(n).some(a=>i[a]!==n[a])){const a=d.findIndex(g=>g.id===e);a>=0?d[a]={...i}:d.push({...i})}else{const a=d.findIndex(g=>g.id===e);a>=0&&d.splice(a,1)}},w=(e, i)=>{const n=u.value.find(a=>a.id===e),s=v.value.find(a=>a.id===e);return n&&s&&n[i]!==s[i]},K=async()=>{try{await Promise.all(d.map(e=>P.patch(`/api/category/${e.id}`,{name:e.name,type:e.type}))),d.length=0,await k()}catch(e){console.error("Fehler beim Speichern der Änderungen:",e)}};return L(k),(e, i)=>(o(),l("div",j,[t("div",H,[O(J,{class:"back-button"})]),i[2]||(i[2]=t("h2",{class:"page-title"},"Kategorien bearbeiten",-1)),i[3]||(i[3]=t("p",{class:"info-text"},[h(" Hinweis: Sie können Felder per "),t("strong",null,"Doppelklick"),h(" bearbeiten. Änderungen werden gesammelt und mit einem einzigen Klick geupdated! Änderungen werden "),t("strong",null,"Rot"),h(" markiert. ")],-1)),b.value?(o(),l("div",R,i[0]||(i[0]=[t("p",null,"Lade Kategorien...",-1)]))):(o(),l("div",W,[t("div",Z,[t("table",q,[i[1]||(i[1]=t("thead",null,[t("tr",null,[t("th",null,"ID"),t("th",null,"Name"),t("th",null,"Typ")])],-1)),t("tbody",null,[(o(!0),l(T,null,z(N.value, n=>(o(),l("tr",{key:n.id,onDblclick: s=>F(n.id)},[t("td",null,p(n.id),1),t("td",{class:V({"modified-field":w(n.id,"name")})},[C(n.id)?D((o(),l("input",{key:0,"onUpdate:modelValue": s=>n.name=s,onInput: s=>y(n.id,"name"),onBlur: s=>x(n.id),class:"edit-input"},null,40,G)),[[E,n.name]]):(o(),l("span",Q,p(n.name),1))],2),t("td",{class:V({"modified-field":w(n.id,"type")})},[C(n.id)?D((o(),l("input",{key:0,"onUpdate:modelValue": s=>n.type=s,onInput: s=>y(n.id,"type"),onBlur: s=>x(n.id),class:"edit-input"},null,40,X)),[[E,n.type]]):(o(),l("span",Y,p(n.type),1))],2)],40,A))),128))])])]),t("div",ee,[t("button",{onClick:S,disabled:r.value===1},"Zurück",8,ne),t("span",null,"Seite "+p(r.value)+" von "+p(_.value),1),t("button",{onClick:$,disabled:r.value===_.value},"Weiter",8,te)]),t("div",se,[t("button",{onClick:K,class:"btn btn-primary",disabled:d.length===0}," Änderungen speichern ",8,ie)])]))]))}},re=M(ae,[["__scopeId","data-v-9e95dc3e"]]);export{re as default};
