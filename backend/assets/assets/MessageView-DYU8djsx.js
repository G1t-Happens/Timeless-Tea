import{_ as B,r as m,o as c,c as g,a as e,t as r,e as _,b as L,v as V,d as $,w as A,q as y,k as M,l as P,F as T,m as F,C as R,p as N}from"./index-BYGPTzin.js";const E={class:"modal-content"},j={class:"modal-title"},I={class:"break-text"},q={class:"actions"},O={key:0,class:"reply-section"},J=["disabled"],K={__name:"MessageModal",props:{message:{type:Object,required:!0}},emits:["close","reply","delete"],setup(d,{emit:u}){const i=u,a=m(!1),l=m(""),b=()=>{i("close")},w=()=>{a.value=!a.value},f=()=>{i("reply",l.value),l.value="",a.value=!1,i("close")},h=async p=>{(await y.fire({backdrop:!1,title:"Nachricht löschen?",text:"Möchten Sie dieses Nachricht wirklich löschen? Dieser Vorgang kann im nachhinein nicht mehr rückgängig gemacht werden!",icon:"warning",showCancelButton:!0,confirmButtonText:"Ja, löschen",cancelButtonText:"Abbrechen"})).isConfirmed&&(i("delete",p),i("close"))};return(p,s)=>(c(),g("div",{class:"modal-overlay",onClick:A(b,["self"])},[e("div",E,[e("h3",j,r(d.message.subject),1),e("p",null,[s[2]||(s[2]=e("strong",null,"Name:",-1)),_(" "+r(d.message.name),1)]),e("p",null,[s[3]||(s[3]=e("strong",null,"Email:",-1)),_(" "+r(d.message.email),1)]),e("p",I,[s[4]||(s[4]=e("strong",null,"Nachricht:",-1)),_(" "+r(d.message.message),1)]),e("p",null,[e("small",null,"Erstellt am: "+r(new Date(d.message.createdAt).toLocaleString()),1)]),e("div",q,[e("button",{class:"btn btn-secondary",onClick:b},"Schließen"),e("button",{class:"btn btn-primary",onClick:w},"Antworten"),e("button",{class:"btn btn-delete",onClick:s[0]||(s[0]=k=>h(d.message.id))},"Löschen")]),a.value?(c(),g("div",O,[L(e("textarea",{"onUpdate:modelValue":s[1]||(s[1]=k=>l.value=k),placeholder:"Schreiben Sie Ihre Antwort hier...",rows:"4"},null,512),[[V,l.value]]),e("button",{disabled:!l.value.trim(),class:"btn btn-send",onClick:f}," Senden ",8,J)])):$("",!0)])]))}},U=B(K,[["__scopeId","data-v-ec11da95"]]),z={class:"messages-container"},G={key:0,class:"loading-spinner"},H={key:1},Q=["onClick"],W={class:"message-header"},X={class:"message-time"},Y={class:"message-details"},Z={class:"pagination"},ee=["disabled"],te=["disabled"],C=4,se={__name:"MessageView",setup(d){const u=m([]),i=m(!1),a=m(1),l=m(null),b=async()=>{i.value=!0;try{const t=await N.get("/api/message");u.value=t.data.data}catch(t){console.error("Fehler beim Laden der Nachrichten:",t)}finally{i.value=!1}},w=t=>new Date(t).toLocaleString(),f=M(()=>u.value.length),h=M(()=>f.value>0?Math.ceil(f.value/C):1),p=M(()=>{const t=(a.value-1)*C,n=t+C;return u.value.slice(t,n)}),s=t=>{t>0&&t<=h.value&&(a.value=t)},k=t=>{l.value=t},x=()=>{l.value=null},S=t=>{y.fire({backdrop:!1,title:"Antwort gesendet!",icon:"success",showConfirmButton:!1,timer:2e3,timerProgressBar:!0}),console.log("Antwort gesendet:",t),x()},D=async t=>{var n,o;try{await N.delete(`/api/message/${t}`),u.value=u.value.filter(v=>v.id!==t),await y.fire({backdrop:!1,title:"Nachricht erfolgreich gelöschen!",icon:"success",showConfirmButton:!1,timer:2e3,timerProgressBar:!0})}catch(v){console.error("Fehler beim Löschen der Nachricht:",v),await y.fire({backdrop:!1,title:"ehler beim Löschen der Nachricht!",text:((o=(n=v.response)==null?void 0:n.data)==null?void 0:o.error)||"Ein unbekannter Fehler ist aufgetreten.",icon:"error",confirmButtonText:"OK"})}};return P(()=>{b()}),(t,n)=>(c(),g("div",z,[i.value?(c(),g("div",G,"Lädt...")):(c(),g("div",H,[(c(!0),g(T,null,F(p.value,o=>(c(),g("div",{class:"message-card",key:o.id,onClick:v=>k(o)},[e("div",W,[e("h3",null,r(o.subject),1),e("span",X,r(w(o.createdAt)),1)]),e("div",Y,[e("p",null,[n[2]||(n[2]=e("strong",null,"Name:",-1)),_(" "+r(o.name),1)])])],8,Q))),128)),e("div",Z,[e("button",{disabled:a.value===1,onClick:n[0]||(n[0]=o=>s(a.value-1)),class:"pagination-button"}," Vorherige ",8,ee),e("span",null,r(a.value)+" / "+r(h.value),1),e("button",{disabled:a.value===h.value,onClick:n[1]||(n[1]=o=>s(a.value+1)),class:"pagination-button"}," Nächste ",8,te)])])),l.value?(c(),R(U,{key:2,message:l.value,onClose:x,onReply:S,onDelete:D},null,8,["message"])):$("",!0)]))}},ne=B(se,[["__scopeId","data-v-afc47f68"]]);export{ne as default};
