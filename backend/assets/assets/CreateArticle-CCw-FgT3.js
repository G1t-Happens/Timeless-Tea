import{_ as D,r as l,l as M,p as x,c as r,f as L,a as t,d as k,b as d,v as p,F as B,m as V,e as A,t as C,w as j,o as n,s as K,q as O}from "./index-BqdhdNvZ.js";import{B as R}from "./BackButton-BFV3CPRB.js";const S={class:"create-article"},T={key:0,class:"image-preview"},z=["src"],E={class:"form-group"},P={class:"form-group"},G={class:"form-group"},I={class:"form-group"},J={class:"form-group"},$={key:0,class:"dropdown-menu"},H=["value"],Q={key:1,class:"selected-options"},W={class:"form-group"},X={__name:"CreateArticle",setup(Y){const c=l(""),m=l(""),v=l(""),f=l(""),i=l([]),g=l([]),b=l(null),y=l(null),w=l(null),q=O(),F= o=>{const e=o.reduce((s, a)=>{const u=a.type||"Andere";return s[u]=s[u]||[],s[u].push(a),s},{});return Object.entries(e).map(([s,a])=>({type:s,categories:a}))};M(async()=>{try{const o=await x.get("/category");g.value=F(o.data)}catch(o){console.error("Fehler beim Laden der Kategorien:",o)}});const N= o=>{b.value=b.value===o?null:o},U=()=>i.value.map(o=>{var e;return(e=g.value.flatMap(s=>s.categories).find(s=>s.id===o))==null?void 0:e.name}),_= o=>{const e=o.target.files;e&&e[0]&&(y.value=e[0],w.value=URL.createObjectURL(e[0]))},h=async()=>{const o=new FormData;o.append("name",c.value),o.append("description",m.value),o.append("price",v.value),o.append("quantity",f.value),o.append("categories",JSON.stringify(i.value)),y.value instanceof File&&o.append("image",y.value);try{await x.post("/product",o),await q.push("/admin")}catch(e){console.error("Fehler beim Erstellen des Artikels:",e)}};return(o, e)=>(n(),r("div",S,[L(R),e[14]||(e[14]=t("h2",{class:"page-title"},"Neuen Artikel erstellen",-1)),t("form",{onSubmit:j(h,["prevent"]),class:"form-container",method:"post",enctype:"multipart/form-data"},[w.value?(n(),r("div",T,[t("img",{src:w.value,alt:"Vorschau des hochgeladenen Bildes",class:"preview-image"},null,8,z)])):k("",!0),t("div",E,[e[6]||(e[6]=t("label",{for:"name",class:"form-label"},"Artikelname",-1)),d(t("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]= s=>c.value=s),id:"name",class:"form-control",required:""},null,512),[[p,c.value]])]),t("div",P,[e[7]||(e[7]=t("label",{for:"description",class:"form-label"},"Beschreibung",-1)),d(t("input",{type:"text","onUpdate:modelValue":e[1]||(e[1]= s=>m.value=s),id:"description",class:"form-control",required:""},null,512),[[p,m.value]])]),t("div",G,[e[8]||(e[8]=t("label",{for:"price",class:"form-label"},"Preis in €",-1)),d(t("input",{type:"number",step:"0.01","onUpdate:modelValue":e[2]||(e[2]= s=>v.value=s),id:"price",class:"form-control",required:""},null,512),[[p,v.value]])]),t("div",I,[e[9]||(e[9]=t("label",{for:"price",class:"form-label"},"Menge in g (Gram)",-1)),d(t("input",{type:"number",step:"0.01","onUpdate:modelValue":e[3]||(e[3]= s=>f.value=s),id:"quantity",class:"form-control",required:""},null,512),[[p,f.value]])]),t("div",J,[e[11]||(e[11]=t("label",{for:"categories",class:"form-label"},"Kategorien",-1)),t("button",{class:"dropdown-button",type:"button",onClick:e[4]||(e[4]= s=>N("categories"))}," ▾ Kategorien wählen "),b.value==="categories"?(n(),r("div",$,[(n(!0),r(B,null,V(g.value, s=>(n(),r("div",{key:s.type},[t("strong",null,C(s.type),1),(n(!0),r(B,null,V(s.categories, a=>(n(),r("div",{key:a.id},[t("label",null,[d(t("input",{type:"checkbox","onUpdate:modelValue":e[5]||(e[5]= u=>i.value=u),value:a.id},null,8,H),[[K,i.value]]),A(" "+C(a.name),1)])]))),128))]))),128))])):k("",!0),i.value.length?(n(),r("div",Q,[e[10]||(e[10]=t("strong",null,"Ausgewählt:",-1)),A(" "+C(U().join(", ")),1)])):k("",!0)]),t("div",W,[e[12]||(e[12]=t("label",{for:"image",class:"form-label"},"Bild hochladen",-1)),t("input",{type:"file",id:"image",class:"form-control",onChange:_,accept:"image/*"},null,32)]),e[13]||(e[13]=t("button",{type:"submit",class:"btn btn-primary w-100"},"Artikel erstellen",-1))],32)]))}},te=D(X,[["__scopeId","data-v-9e8cbcc1"]]);export{te as default};
