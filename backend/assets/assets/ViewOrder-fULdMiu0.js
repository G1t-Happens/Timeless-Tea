import{_ as H,r as A,y as x,k as B,l as j,c as m,f as J,a as t,t as d,n as y,e as c,w as C,b as u,D as S,G as Q,v as p,d as f,F as W,m as X,p as h,o as v,A as _,q as g}from"./index-Cy6hZbvz.js";import{B as ee}from"./BackButton-C7Seo1Gr.js";const te={key:0,class:"view-order"},re={class:"page-title"},ae={class:"page-title"},ie={class:"order-summary"},ne={class:"summary-card"},se={class:"info-section"},le={class:"info-section"},oe={class:"form-group"},de=["disabled"],ue={class:"info-section"},pe={class:"form-group"},me={class:"form-group"},ve={class:"form-group"},ye={class:"form-group"},fe=["disabled"],ge={class:"form-group"},ce={class:"form-group"},be={class:"form-group"},De={class:"form-group"},he={class:"form-group"},xe={class:"form-group"},Be={class:"form-group"},Ce=["disabled"],Ne={class:"info-section"},Se={class:"form-group"},Ee={key:0},ke={key:0,class:"error"},we={key:0,class:"error"},Ve={key:0,class:"error"},Oe={key:1},Ae={key:0,class:"error"},Ue={key:2},Fe={key:0,class:"error"},qe=["disabled"],Pe={class:"products-section"},Ie={class:"product-list"},$e=["src","alt"],Le={class:"product-info"},ze={key:1,class:"loading"},Ze={__name:"ViewOrder",setup(Ke){const U=_(),a=A(null),b=A(""),o=x({carrier:"",deliveryStatus:"",estimatedDeliveryDate:"",shippingDate:""}),l=x({country:"",state:"",city:"",postalCode:"",street:"",houseNumber:"",addressAddition:""}),n=x({paymentOption:"",creditCardNumber:"",expiryDate:"",paypalEmail:"",iban:"",cvc:""}),s=x({creditCardNumber:"",expiryDate:"",cvc:"",iban:"",paypalEmail:""}),F=i=>({open:"Offen",processing:"In Bearbeitung",successful:"Erfolgreich",failed:"Fehlgeschlagen",refunded:"Erstattet",canceled:"Storniert"})[i]||i,N=i=>new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR"}).format(i),E=i=>i?new Date(i).toLocaleDateString("de-DE",{year:"numeric",month:"long",day:"numeric"}):"Kein Datum",k=B(()=>{var i;return b.value!==(((i=a.value)==null?void 0:i.orderStatus)||"")}),w=B(()=>{var i;return(i=a.value)!=null&&i.shipping?o.carrier!==a.value.shipping.carrier||o.deliveryStatus!==a.value.shipping.deliveryStatus||o.estimatedDeliveryDate!==D(a.value.shipping.estimatedDeliveryDate)||o.shippingDate!==D(a.value.shipping.shippingDate):!1}),V=B(()=>{var i,e;return(e=(i=a.value)==null?void 0:i.shipping)!=null&&e.address?l.country!==a.value.shipping.address.country||l.city!==a.value.shipping.address.city||l.postalCode!==a.value.shipping.address.postalCode||l.street!==a.value.shipping.address.street||l.houseNumber!==a.value.shipping.address.houseNumber||(l.addressAddition||"")!==(a.value.shipping.address.addressAddition||""):!1}),O=B(()=>{var e;if(!((e=a.value)!=null&&e.payment)||!!s.creditCardNumber||!!s.expiryDate||!!s.cvc||!!s.iban||!!s.paypalEmail)return!1;switch(n.paymentOption){case"credit card":return!n.creditCardNumber||!n.expiryDate||!n.cvc?!1:n.paymentOption!==a.value.payment.paymentOption||n.creditCardNumber!==a.value.payment.creditCardNumber||n.expiryDate!==a.value.payment.expiryDate||n.cvc!==a.value.payment.cvc;case"bank transfer":return n.iban?n.paymentOption!==a.value.payment.paymentOption||n.iban!==a.value.payment.iban:!1;case"paypal":return n.paypalEmail?n.paymentOption!==a.value.payment.paymentOption||n.paypalEmail!==a.value.payment.paypalEmail:!1;default:return!1}}),q=async()=>{try{const i=U.params.id,{data:e}=await h.get(`/api/order/${i}`);a.value=e,P()}catch(i){console.error("Fehler beim Laden der Bestellung:",i)}},P=()=>{a.value&&(b.value=a.value.orderStatus,o.carrier=a.value.shipping.carrier,o.deliveryStatus=a.value.shipping.deliveryStatus,o.estimatedDeliveryDate=D(a.value.shipping.estimatedDeliveryDate),o.shippingDate=D(a.value.shipping.shippingDate),l.country=a.value.shipping.address.country,l.city=a.value.shipping.address.city,l.postalCode=a.value.shipping.address.postalCode,l.street=a.value.shipping.address.street,l.houseNumber=a.value.shipping.address.houseNumber,l.addressAddition=a.value.shipping.address.addressAddition||"",n.paymentOption=a.value.payment.paymentOption,n.creditCardNumber=a.value.payment.creditCardNumber||"",n.expiryDate=D(a.value.payment.expiryDate)||"",n.cvc=a.value.payment.cvc||"",n.paypalEmail=a.value.payment.paypalEmail||"",n.iban=a.value.payment.iban||"")},D=i=>{if(!i)return"";const e=new Date(i);if(isNaN(e.getTime()))return console.warn("Ungültiges Datum:",i),"";const r=e.getFullYear(),Y=String(e.getMonth()+1).padStart(2,"0"),R=String(e.getDate()).padStart(2,"0");return`${r}-${Y}-${R}`},I=async()=>{var i,e;try{const r={orderStatus:b.value};await h.patch(`/api/order/${a.value.id}/status`,r),a.value.orderStatus=b.value,await g.fire({backdrop:!1,title:"Status geupdated!",text:`Der Status der Bestellung: "${a.value.id}" wurde erfolgreich geupdated.`,icon:"success",showConfirmButton:!1,timer:2e3,timerProgressBar:!0})}catch(r){console.error("Fehler beim Statusupdate der Bestellung:",r),await g.fire({backdrop:!1,title:"Fehler beim Statusupdate der Bestellung!",text:((e=(i=r.response)==null?void 0:i.data)==null?void 0:e.error)||"Ein unbekannter Fehler ist aufgetreten.",icon:"error",confirmButtonText:"OK"})}},$=async()=>{var i,e;try{const r={carrier:o.carrier,deliveryStatus:o.deliveryStatus,estimatedDeliveryDate:o.estimatedDeliveryDate,shippingDate:o.shippingDate};await h.patch(`/api/order/${a.value.id}/shipping`,r),a.value.shipping={...a.value.shipping,...r},await g.fire({backdrop:!1,title:"Versandinformationen geupdated!",text:`Die Versandinformation der Bestellung: "${a.value.id}" wurde erfolgreich geupdated.`,icon:"success",showConfirmButton:!1,timer:2e3,timerProgressBar:!0})}catch(r){console.error("Fehler beim Updaten der Versandinformation:",r),await g.fire({backdrop:!1,title:"Fehler beim Update der Versandinformation der Bestellung!",text:((e=(i=r.response)==null?void 0:i.data)==null?void 0:e.error)||"Ein unbekannter Fehler ist aufgetreten.",icon:"error",confirmButtonText:"OK"})}},L=async()=>{var i,e;try{const r={country:l.country,state:l.state,city:l.city,postalCode:l.postalCode,street:l.street,houseNumber:l.houseNumber,addressAddition:l.addressAddition||null};await h.patch(`/api/order/${a.value.id}/address`,r),a.value.shipping.address={...a.value.shipping.address,...r},await g.fire({backdrop:!1,title:"Lieferadresse geupdated!",text:`Die Lieferadresse der Bestellung: "${a.value.id}" wurde erfolgreich geupdated.`,icon:"success",showConfirmButton:!1,timer:2e3,timerProgressBar:!0})}catch(r){console.error("Fehler beim Updaten der Lieferadresse:",r),await g.fire({backdrop:!1,title:"Fehler beim Update der Lieferadresse der Bestellung!",text:((e=(i=r.response)==null?void 0:i.data)==null?void 0:e.error)||"Ein unbekannter Fehler ist aufgetreten.",icon:"error",confirmButtonText:"OK"})}},z=async()=>{var i,e;try{const r={paymentOption:n.paymentOption,creditCardNumber:n.paymentOption==="credit card"?n.creditCardNumber:null,cvc:n.paymentOption==="credit card"?n.cvc:null,expiryDate:n.paymentOption==="credit card"?n.expiryDate:null,paypalEmail:n.paymentOption==="paypal"?n.paypalEmail:null,iban:n.paymentOption==="bank transfer"?n.iban:null};await h.patch(`/api/order/${a.value.id}/payment`,r),a.value.payment={...a.value.payment,...r},await g.fire({backdrop:!1,title:"Zahlungsinformationen geupdated!",text:`Die Zahlungsinformationen der Bestellung: "${a.value.id}" wurde erfolgreich geupdated.`,icon:"success",showConfirmButton:!1,timer:2e3,timerProgressBar:!0})}catch(r){console.error("Fehler beim Update der Zahlungsinformationen:",r),await g.fire({backdrop:!1,title:"Fehler beim Update der Zahlungsinformationen der Bestellung!",text:((e=(i=r.response)==null?void 0:i.data)==null?void 0:e.error)||"Ein unbekannter Fehler ist aufgetreten.",icon:"error",confirmButtonText:"OK"})}};function Z(){const i=(n.creditCardNumber||"").replace(/\s+/g,"");if(!i){s.creditCardNumber="";return}/^\d{13,19}$/.test(i)?s.creditCardNumber="":s.creditCardNumber="Bitte eine gültige Kreditkartennummer (13–19 Ziffern) eingeben"}function K(){const i=n.expiryDate;if(!i){s.expiryDate="";return}const e=new Date(i);if(isNaN(e.valueOf())){s.expiryDate="Ungültiges Datum";return}e<new Date?s.expiryDate="Das Ablaufdatum darf nicht in der Vergangenheit liegen":s.expiryDate=""}function M(){const i=n.cvc;if(!i){s.cvc="";return}/^\d{3,4}$/.test(i)?s.cvc="":s.cvc="Bitte einen gültigen CVC (3–4 Ziffern) eingeben"}function T(){const i=n.iban;if(!i){s.iban="";return}/^[A-Za-z0-9]{15,34}$/.test(i)?s.iban="":s.iban="Bitte eine gültige IBAN (15–34 alphanumerische Zeichen) eingeben"}function G(){const i=n.paypalEmail;if(!i){s.paypalEmail="";return}/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(i)?s.paypalEmail="":s.paypalEmail="Bitte eine gültige E-Mail-Adresse eingeben"}return j(()=>{q()}),(i,e)=>a.value?(v(),m("div",te,[J(ee),t("h2",re,"Bestellung #"+d(a.value.id),1),t("div",ae,[t("span",{class:y(["status",a.value.orderStatus])},d(F(a.value.orderStatus)),3)]),t("main",null,[t("section",ie,[t("div",ne,[e[21]||(e[21]=t("h3",null,"Bestellübersicht",-1)),t("ul",null,[t("li",null,[e[18]||(e[18]=t("span",null,"Gesamtbetrag: ",-1)),t("span",null,d(N(a.value.totalAmount)),1)]),t("li",null,[e[19]||(e[19]=t("span",null,"Erstellt: ",-1)),t("span",null,d(E(a.value.createdAt)),1)]),t("li",null,[e[20]||(e[20]=t("span",null,"Aktualisiert: ",-1)),t("span",null,d(E(a.value.updatedAt)),1)])])])]),t("section",se,[e[26]||(e[26]=t("h3",null,"Benutzerinformationen",-1)),t("ul",null,[t("li",null,[e[22]||(e[22]=t("strong",null,"Benutzer ID:",-1)),c(" "+d(a.value.user.id),1)]),t("li",null,[e[23]||(e[23]=t("strong",null,"Vorname:",-1)),c(" "+d(a.value.user.firstName),1)]),t("li",null,[e[24]||(e[24]=t("strong",null,"Nachname:",-1)),c(" "+d(a.value.user.lastName),1)]),t("li",null,[e[25]||(e[25]=t("strong",null,"Email:",-1)),c(" "+d(a.value.user.emailAddress),1)])])]),t("section",le,[e[29]||(e[29]=t("h3",null,"Status der Bestellung",-1)),t("form",{onSubmit:C(I,["prevent"])},[t("div",oe,[e[28]||(e[28]=t("label",{for:"orderStatus"},"Bestellstatus*:",-1)),u(t("select",{id:"orderStatus","onUpdate:modelValue":e[0]||(e[0]=r=>b.value=r),required:""},e[27]||(e[27]=[Q('<option value="open" data-v-c82c3a50>Offen</option><option value="processing" data-v-c82c3a50>In Bearbeitung</option><option value="successful" data-v-c82c3a50>Erfolgreich</option><option value="failed" data-v-c82c3a50>Fehlgeschlagen</option><option value="refunded" data-v-c82c3a50>Erstattet</option><option value="canceled" data-v-c82c3a50>Storniert</option>',6)]),512),[[S,b.value]])]),t("button",{type:"submit",class:y(["btn",{"btn-disabled":!k.value}]),disabled:!k.value}," Aktualisieren ",10,de)],32)]),t("section",ue,[e[42]||(e[42]=t("h3",null,"Versandinformationen",-1)),t("form",{onSubmit:C($,["prevent"])},[t("div",pe,[e[30]||(e[30]=t("label",{for:"carrier"},"Versanddienst*:",-1)),u(t("input",{type:"text",id:"carrier","onUpdate:modelValue":e[1]||(e[1]=r=>o.carrier=r),maxlength:"50",required:""},null,512),[[p,o.carrier]])]),t("div",me,[e[32]||(e[32]=t("label",{for:"deliveryStatus"},"Lieferstatus*:",-1)),u(t("select",{id:"deliveryStatus","onUpdate:modelValue":e[2]||(e[2]=r=>o.deliveryStatus=r),required:""},e[31]||(e[31]=[t("option",{value:"not shipped"},"Nicht versandt",-1),t("option",{value:"shipped"},"Versandt",-1),t("option",{value:"delivered"},"Geliefert",-1)]),512),[[S,o.deliveryStatus]])]),t("div",ve,[e[33]||(e[33]=t("label",{for:"estimatedDeliveryDate"},"Geschätztes Lieferdatum*:",-1)),u(t("input",{type:"date",id:"estimatedDeliveryDate","onUpdate:modelValue":e[3]||(e[3]=r=>o.estimatedDeliveryDate=r),required:""},null,512),[[p,o.estimatedDeliveryDate]])]),t("div",ye,[e[34]||(e[34]=t("label",{for:"shippingDate"},"Versanddatum*:",-1)),u(t("input",{type:"date",id:"shippingDate","onUpdate:modelValue":e[4]||(e[4]=r=>o.shippingDate=r),required:""},null,512),[[p,o.shippingDate]])]),t("button",{type:"submit",class:y(["btn",{"btn-disabled":!w.value}]),disabled:!w.value}," Aktualisieren ",10,fe)],32),e[43]||(e[43]=t("hr",{class:"section-divider"},null,-1)),e[44]||(e[44]=t("h4",null,"Lieferadresse",-1)),t("form",{onSubmit:C(L,["prevent"])},[t("div",ge,[e[35]||(e[35]=t("label",{for:"country"},"Land*:",-1)),u(t("input",{type:"text",id:"country","onUpdate:modelValue":e[5]||(e[5]=r=>l.country=r),maxlength:"60",required:""},null,512),[[p,l.country]])]),t("div",ce,[e[36]||(e[36]=t("label",{for:"state"},"Bundesland(optional):",-1)),u(t("input",{type:"text",id:"state","onUpdate:modelValue":e[6]||(e[6]=r=>l.state=r),maxlength:"50"},null,512),[[p,l.state]])]),t("div",be,[e[37]||(e[37]=t("label",{for:"city"},"Stadt*:",-1)),u(t("input",{type:"text",id:"city","onUpdate:modelValue":e[7]||(e[7]=r=>l.city=r),maxlength:"50",required:""},null,512),[[p,l.city]])]),t("div",De,[e[38]||(e[38]=t("label",{for:"postalCode"},"Postleitzahl*:",-1)),u(t("input",{type:"text",id:"postalCode","onUpdate:modelValue":e[8]||(e[8]=r=>l.postalCode=r),maxlength:"10",required:""},null,512),[[p,l.postalCode]])]),t("div",he,[e[39]||(e[39]=t("label",{for:"street"},"Straße*:",-1)),u(t("input",{type:"text",id:"street","onUpdate:modelValue":e[9]||(e[9]=r=>l.street=r),maxlength:"30",required:""},null,512),[[p,l.street]])]),t("div",xe,[e[40]||(e[40]=t("label",{for:"houseNumber"},"Hausnummer*:",-1)),u(t("input",{type:"text",id:"houseNumber","onUpdate:modelValue":e[10]||(e[10]=r=>l.houseNumber=r),maxlength:"8",required:""},null,512),[[p,l.houseNumber]])]),t("div",Be,[e[41]||(e[41]=t("label",{for:"addressAddition"},"Zusatz(optional):",-1)),u(t("input",{type:"text",id:"addressAddition","onUpdate:modelValue":e[11]||(e[11]=r=>l.addressAddition=r),maxlength:"150"},null,512),[[p,l.addressAddition]])]),t("button",{type:"submit",class:y(["btn",{"btn-disabled":!V.value}]),disabled:!V.value}," Aktualisieren ",10,Ce)],32)]),t("section",Ne,[e[52]||(e[52]=t("h3",null,"Zahlungsinformationen",-1)),t("form",{onSubmit:C(z,["prevent"])},[t("div",Se,[e[46]||(e[46]=t("label",{for:"paymentOption"},"Zahlungsmethode*:",-1)),u(t("select",{id:"paymentOption","onUpdate:modelValue":e[12]||(e[12]=r=>n.paymentOption=r),required:""},e[45]||(e[45]=[t("option",{value:"credit card"},"Kreditkarte",-1),t("option",{value:"paypal"},"PayPal",-1),t("option",{value:"bank transfer"},"Banküberweisung",-1)]),512),[[S,n.paymentOption]])]),n.paymentOption==="credit card"?(v(),m("div",Ee,[t("div",{class:y(["form-group",{"has-error":s.creditCardNumber}])},[e[47]||(e[47]=t("label",{for:"creditCardNumber"},"Kreditkartennummer*:",-1)),u(t("input",{type:"text",id:"creditCardNumber","onUpdate:modelValue":e[13]||(e[13]=r=>n.creditCardNumber=r),placeholder:"z.B. 1234567890123456",minlength:"13",maxlength:"19",onInput:Z,required:""},null,544),[[p,n.creditCardNumber]]),s.creditCardNumber?(v(),m("span",ke,d(s.creditCardNumber),1)):f("",!0)],2),t("div",{class:y(["form-group",{"has-error":s.expiryDate}])},[e[48]||(e[48]=t("label",{for:"expiryDate"},"Ablaufdatum*:",-1)),u(t("input",{type:"date",id:"expiryDate","onUpdate:modelValue":e[14]||(e[14]=r=>n.expiryDate=r),placeholder:"YYYY-MM-DD",onBlur:K,required:""},null,544),[[p,n.expiryDate]]),s.expiryDate?(v(),m("span",we,d(s.expiryDate),1)):f("",!0)],2),t("div",{class:y(["form-group",{"has-error":s.cvc}])},[e[49]||(e[49]=t("label",{for:"cvc"},"Kartenprüfnummer(CVC)*:",-1)),u(t("input",{type:"text",id:"cvc","onUpdate:modelValue":e[15]||(e[15]=r=>n.cvc=r),placeholder:"z.B. 123",minlength:"3",maxlength:"4",onInput:M,required:""},null,544),[[p,n.cvc]]),s.cvc?(v(),m("span",Ve,d(s.cvc),1)):f("",!0)],2)])):f("",!0),n.paymentOption==="paypal"?(v(),m("div",Oe,[t("div",{class:y(["form-group",{"has-error":s.paypalEmail}])},[e[50]||(e[50]=t("label",{for:"paypalEmail"},"PayPal Email*:",-1)),u(t("input",{type:"email",id:"paypalEmail","onUpdate:modelValue":e[16]||(e[16]=r=>n.paypalEmail=r),placeholder:"z.B. user@mail.com",minlength:"1",maxlength:"100",onInput:G,required:""},null,544),[[p,n.paypalEmail]]),s.paypalEmail?(v(),m("span",Ae,d(s.paypalEmail),1)):f("",!0)],2)])):f("",!0),n.paymentOption==="bank transfer"?(v(),m("div",Ue,[t("div",{class:y(["form-group",{"has-error":s.iban}])},[e[51]||(e[51]=t("label",{for:"iban"},"IBAN*:",-1)),u(t("input",{type:"text",id:"iban","onUpdate:modelValue":e[17]||(e[17]=r=>n.iban=r),placeholder:"z.B. DE89370400440532013000",minlength:"15",maxlength:"34",onInput:T,required:""},null,544),[[p,n.iban]]),s.iban?(v(),m("span",Fe,d(s.iban),1)):f("",!0)],2)])):f("",!0),t("button",{type:"submit",class:y(["btn",{"btn-disabled":!O.value}]),disabled:!O.value}," Aktualisieren ",10,qe)],32)]),t("section",Pe,[e[56]||(e[56]=t("h3",null,"Produkte",-1)),t("div",Ie,[(v(!0),m(W,null,X(a.value.orderProducts,r=>(v(),m("div",{key:r.id,class:"product-card"},[t("img",{src:r.product.image,alt:r.product.name},null,8,$e),t("div",Le,[t("h4",null,d(r.product.name),1),t("p",null,d(r.product.description),1),t("ul",null,[t("li",null,[e[53]||(e[53]=t("strong",null,"Preis: ",-1)),c(" "+d(N(r.product.price)),1)]),t("li",null,[e[54]||(e[54]=t("strong",null,"Menge: ",-1)),c(" "+d(r.quantity),1)]),t("li",null,[e[55]||(e[55]=t("strong",null,"Gesamt: ",-1)),c(" "+d(N(r.product.price*r.quantity)),1)])])])]))),128))])])])])):(v(),m("div",ze,e[57]||(e[57]=[t("p",null,"Bestelldaten werden geladen...",-1)])))}},Ge=H(Ze,[["__scopeId","data-v-c82c3a50"]]);export{Ge as default};
