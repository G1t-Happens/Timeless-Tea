import{_ as N,r as m,o as c,c as g,a as e,t as r,e as k,b as L,v as V,d as B,w as A,q as y,k as x,l as P,F as T,m as F,C as R,p as $}from"./index-oTY3-4pI.js";const E={class:"modal-content"},j={class:"modal-title break-text"},I={class:"break-text"},q={class:"break-text"},O={class:"break-text"},J={class:"actions"},K={key:0,class:"reply-section"},U=["disabled"],z={__name:"MessageModal",props:{message:{type:Object,required:!0}},emits:["close","reply","delete"],setup(d,{emit:u}){const i=u,n=m(!1),l=m(""),b=()=>{i("close")},w=()=>{n.value=!n.value},p=()=>{i("reply",l.value),l.value="",n.value=!1,i("close")},h=async f=>{(await y.fire({backdrop:!1,title:"Nachricht löschen?",text:"Möchten Sie dieses Nachricht wirklich löschen? Dieser Vorgang kann im nachhinein nicht mehr rückgängig gemacht werden!",icon:"warning",showCancelButton:!0,confirmButtonText:"Ja, löschen",cancelButtonText:"Abbrechen"})).isConfirmed&&(i("delete",f),i("close"))};return(f,s)=>(c(),g("div",{class:"modal-overlay",onClick:A(b,["self"])},[e("div",E,[e("h3",j,r(d.message.subject),1),e("p",I,[s[2]||(s[2]=e("strong",null,"Name:",-1)),k(" "+r(d.message.name),1)]),e("p",q,[s[3]||(s[3]=e("strong",null,"Email:",-1)),k(" "+r(d.message.email),1)]),e("p",O,[s[4]||(s[4]=e("strong",null,"Nachricht:",-1)),k(" "+r(d.message.message),1)]),e("p",null,[e("small",null,"Erstellt am: "+r(new Date(d.message.createdAt).toLocaleString()),1)]),e("div",J,[e("button",{class:"btn btn-secondary",onClick:b},"Schließen"),e("button",{class:"btn btn-primary",onClick:w},"Antworten"),e("button",{class:"btn btn-delete",onClick:s[0]||(s[0]=_=>h(d.message.id))},"Löschen")]),n.value?(c(),g("div",K,[L(e("textarea",{"onUpdate:modelValue":s[1]||(s[1]=_=>l.value=_),placeholder:"Schreiben Sie Ihre Antwort hier...",rows:"4"},null,512),[[V,l.value]]),e("button",{disabled:!l.value.trim(),class:"btn btn-send",onClick:p}," Senden ",8,U)])):B("",!0)])]))}},G=N(z,[["__scopeId","data-v-de8596bd"]]),H={class:"messages-container"},Q={key:0,class:"loading-spinner"},W={key:1},X=["onClick"],Y={class:"message-header"},Z={class:"break-text"},ee={class:"message-time"},te={class:"message-details"},se={class:"break-text"},ae={class:"pagination"},ne=["disabled"],le=["disabled"],M=4,oe={__name:"MessageView",setup(d){const u=m([]),i=m(!1),n=m(1),l=m(null),b=async()=>{i.value=!0;try{const t=await $.get("/api/message");u.value=t.data.data}catch(t){console.error("Fehler beim Laden der Nachrichten:",t)}finally{i.value=!1}},w=t=>new Date(t).toLocaleString(),p=x(()=>u.value.length),h=x(()=>p.value>0?Math.ceil(p.value/M):1),f=x(()=>{const t=(n.value-1)*M,a=t+M;return u.value.slice(t,a)}),s=t=>{t>0&&t<=h.value&&(n.value=t)},_=t=>{l.value=t},C=()=>{l.value=null},S=t=>{y.fire({backdrop:!1,title:"Antwort gesendet!",icon:"success",showConfirmButton:!1,timer:2e3,timerProgressBar:!0}),console.log("Antwort gesendet:",t),C()},D=async t=>{var a,o;try{await $.delete(`/api/message/${t}`),u.value=u.value.filter(v=>v.id!==t),await y.fire({backdrop:!1,title:"Nachricht erfolgreich gelöschen!",icon:"success",showConfirmButton:!1,timer:2e3,timerProgressBar:!0})}catch(v){console.error("Fehler beim Löschen der Nachricht:",v),await y.fire({backdrop:!1,title:"ehler beim Löschen der Nachricht!",text:((o=(a=v.response)==null?void 0:a.data)==null?void 0:o.error)||"Ein unbekannter Fehler ist aufgetreten.",icon:"error",confirmButtonText:"OK"})}};return P(()=>{b()}),(t,a)=>(c(),g("div",H,[i.value?(c(),g("div",Q,"Lädt...")):(c(),g("div",W,[(c(!0),g(T,null,F(f.value,o=>(c(),g("div",{class:"message-card",key:o.id,onClick:v=>_(o)},[e("div",Y,[e("h3",Z,r(o.subject),1),e("span",ee,r(w(o.createdAt)),1)]),e("div",te,[e("p",null,[a[2]||(a[2]=e("strong",null,"Name:",-1)),a[3]||(a[3]=k()),e("span",se,r(o.name),1)])])],8,X))),128)),e("div",ae,[e("button",{disabled:n.value===1,onClick:a[0]||(a[0]=o=>s(n.value-1)),class:"pagination-button"}," Vorherige ",8,ne),e("span",null,r(n.value)+" / "+r(h.value),1),e("button",{disabled:n.value===h.value,onClick:a[1]||(a[1]=o=>s(n.value+1)),class:"pagination-button"}," Nächste ",8,le)])])),l.value?(c(),R(G,{key:2,message:l.value,onClose:C,onReply:S,onDelete:D},null,8,["message"])):B("",!0)]))}},ie=N(oe,[["__scopeId","data-v-e3594719"]]);export{ie as default};
