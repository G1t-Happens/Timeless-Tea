import{_ as M,r as o,l as E,p as A,c as a,f as K,a as r,d as k,b as d,v as c,F as B,m as C,e as h,t as x,w as L,o as n,x as O,s as S,q as F}from"./index-BTg0P_Sh.js";import{B as T}from"./BackButton-D8b4DVOL.js";const j={class:"create-article"},P={key:0,class:"image-preview"},R=["src"],z={class:"form-group"},$={class:"form-group"},G={class:"form-group"},I={class:"form-group"},J={class:"form-group"},H={key:0,class:"dropdown-menu"},Q=["value"],W={key:1,class:"selected-options"},X={class:"form-group"},Y={__name:"CreateArticle",setup(Z){const p=o(""),m=o(""),v=o(""),f=o(""),i=o([]),g=o([]),b=o(null),y=o(null),w=o(null),V=S(),q=s=>{const e=s.reduce((t,l)=>{const u=l.type||"Andere";return t[u]=t[u]||[],t[u].push(l),t},{});return Object.entries(e).map(([t,l])=>({type:t,categories:l}))};E(async()=>{try{const s=await A.get("/api/category");g.value=q(s.data)}catch(s){console.error("Fehler beim Laden der Kategorien:",s)}});const D=s=>{b.value=b.value===s?null:s},N=()=>i.value.map(s=>{var e;return(e=g.value.flatMap(t=>t.categories).find(t=>t.id===s))==null?void 0:e.name}),U=s=>{const e=s.target.files;e&&e[0]&&(y.value=e[0],w.value=URL.createObjectURL(e[0]))},_=async()=>{var e,t;const s=new FormData;s.append("name",p.value),s.append("description",m.value),s.append("price",v.value),s.append("quantity",f.value),s.append("categories",JSON.stringify(i.value)),y.value instanceof File&&s.append("image",y.value);try{await A.post("/api/product",s),await F.fire({title:"Artikel erstellt!",text:`Artikel: "${p.value}" wurde erfolgreich erstellt.`,icon:"success",showConfirmButton:!1,timer:2e3,timerProgressBar:!0}),await V.push({name:"AdminDasboard"})}catch(l){console.error("Fehler beim Erstellen des Artikels:",l),await F.fire({title:"Fehler beim Erstellen des Artikels!",text:((t=(e=l.response)==null?void 0:e.data)==null?void 0:t.error)||"Ein unbekannter Fehler ist aufgetreten.",icon:"error",confirmButtonText:"OK"})}};return(s,e)=>(n(),a("div",j,[K(T),e[14]||(e[14]=r("h2",{class:"page-title"},"Neuen Artikel erstellen",-1)),r("form",{onSubmit:L(_,["prevent"]),class:"form-container",method:"post",enctype:"multipart/form-data"},[w.value?(n(),a("div",P,[r("img",{src:w.value,alt:"Vorschau des hochgeladenen Bildes",class:"preview-image"},null,8,R)])):k("",!0),r("div",z,[e[6]||(e[6]=r("label",{for:"name",class:"form-label"},"Artikelname",-1)),d(r("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=t=>p.value=t),id:"name",class:"form-control",required:""},null,512),[[c,p.value]])]),r("div",$,[e[7]||(e[7]=r("label",{for:"description",class:"form-label"},"Beschreibung",-1)),d(r("input",{type:"text","onUpdate:modelValue":e[1]||(e[1]=t=>m.value=t),id:"description",class:"form-control",required:""},null,512),[[c,m.value]])]),r("div",G,[e[8]||(e[8]=r("label",{for:"price",class:"form-label"},"Preis in €",-1)),d(r("input",{type:"number",step:"0.01","onUpdate:modelValue":e[2]||(e[2]=t=>v.value=t),id:"price",class:"form-control",required:""},null,512),[[c,v.value]])]),r("div",I,[e[9]||(e[9]=r("label",{for:"price",class:"form-label"},"Menge in g (Gram)",-1)),d(r("input",{type:"number",step:"0.01","onUpdate:modelValue":e[3]||(e[3]=t=>f.value=t),id:"quantity",class:"form-control",required:""},null,512),[[c,f.value]])]),r("div",J,[e[11]||(e[11]=r("label",{for:"categories",class:"form-label"},"Kategorien",-1)),r("button",{class:"dropdown-button",type:"button",onClick:e[4]||(e[4]=t=>D("categories"))}," ▾ Kategorien wählen "),b.value==="categories"?(n(),a("div",H,[(n(!0),a(B,null,C(g.value,t=>(n(),a("div",{key:t.type},[r("strong",null,x(t.type),1),(n(!0),a(B,null,C(t.categories,l=>(n(),a("div",{key:l.id},[r("label",null,[d(r("input",{type:"checkbox","onUpdate:modelValue":e[5]||(e[5]=u=>i.value=u),value:l.id},null,8,Q),[[O,i.value]]),h(" "+x(l.name),1)])]))),128))]))),128))])):k("",!0),i.value.length?(n(),a("div",W,[e[10]||(e[10]=r("strong",null,"Ausgewählt:",-1)),h(" "+x(N().join(", ")),1)])):k("",!0)]),r("div",X,[e[12]||(e[12]=r("label",{for:"image",class:"form-label"},"Bild hochladen",-1)),r("input",{type:"file",id:"image",class:"form-control",onChange:U,accept:"image/*"},null,32)]),e[13]||(e[13]=r("button",{type:"submit",class:"btn btn-primary w-100"},"Artikel erstellen",-1))],32)]))}},re=M(Y,[["__scopeId","data-v-c87d328e"]]);export{re as default};
